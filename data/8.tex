\chapter{SİBER TEHDİT İSTİHBARATI VE TEHDİT AVCILIĞI}

Bu bölüm, siber güvenlik uzmanlarının tehdit ortamını anlamalarını, proaktif savunma stratejileri geliştirmelerini ve saldırgan davranışlarını etkili bir şekilde tespit etmelerini sağlamak amacıyla siber tehdit istihbaratı (CTI) ve tehdit avcılığı (threat hunting) disiplinlerini temelden ileri seviyeye taşıyan kapsamlı bir eğitim sunar. Siber güvenlik alanı sürekli evrilen bir yapıya sahip olduğundan, bu alandaki profesyonellerin reaktif yaklaşımlardan proaktif stratejilere geçiş yapmaları zorunluluk haline gelmiştir. Bu doküman, hem teorik çerçeveleri hem de pratik uygulamaları ele alarak, analistlerin veriden eyleme dönüştürülebilir istihbarat üretme ve güvenlik operasyonlarını bu içgörülerle güçlendirme yetkinliklerini artırmayı hedefler.

\section{Cyber Threat Intelligence (CTI) Fundamentals}
Siber Tehdit İstihbaratı (CTI), bir kuruluşun siber tehditlere karşı savunma yeteneklerini güçlendirmek için toplanan, işlenen ve analiz edilen bilgidir. CTI, bir kuruluşun potansiyel saldırganları, onların motivasyonlarını, yeteneklerini ve kullandıkları altyapıyı anlamasına yardımcı olur. Bu bilgiler, güvenlik ekiplerinin proaktif bir savunma stratejisi oluşturmasına, olay müdahale süreçlerini iyileştirmesine ve kaynaklarını daha etkili bir şekilde tahsis etmesine olanak tanır.

\subsection{Threat Intelligence Lifecycle ve Collection Methods}

Tehdit istihbaratı yaşam döngüsü, ham veriyi değerli istihbarata dönüştüren ve sürekli bir geri bildirim döngüsü ile kendini yenileyen, yapılandırılmış bir süreçtir. Bu döngü, CTI programının temelini oluşturur ve reaktif bir modelden proaktif bir savunma yaklaşımına geçişin temelini atar.

\textbf{Yaşam Döngüsü Aşamaları:}

\begin{enumerate}
    \item \textbf{Gereksinimler (Requirements):} Döngünün ilk ve en kritik aşamasıdır. Bu aşamada, güvenlik ekipleri, iş birimleri ve üst düzey yöneticiler bir araya gelerek istihbarat ihtiyaçlarını net bir şekilde tanımlar. Bu, korunması gereken en kritik varlıkları (“Crown Jewels”), organizasyonun karşılaştığı riskleri ve bu riskleri azaltmak için hangi bilgilerin gerekli olduğunu belirlemeyi içerir. Gereksinimlerin net bir şekilde belirlenmesi, istihbarat toplama çabalarının boşa gitmesini engeller ve kaynakların doğru hedeflere yönlendirilmesini sağlar. Aksi halde, ekipler alakasız verileri takip ederek zaman ve kaynak kaybedebilir veya kritik tehditleri gözden kaçırabilir.
    \item \textbf{Toplama (Collection):} Bu aşama, tanımlanan gereksinimleri karşılamak için geniş bir yelpazedeki kaynaklardan ham veri toplamayı içerir. Toplanan veriler hem teknik (Indicator of Compromise - IOC) hem de bağlamsal bilgiler (TTP’ler, motivasyonlar) içermelidir.
    \begin{itemize}
        \item \textbf{OSINT (Open-Source Intelligence):} Genel kullanıma açık ve serbestçe erişilebilen kaynaklardan bilgi toplama. Bu kaynaklar arasında haberler, bloglar, sosyal medya platformları, akademik çalışmalar ve endüstri raporları bulunur.
        \item \textbf{Ticari Tehdit Beslemeleri:} Güvenlik firmaları tarafından sağlanan ve genellikle otomatik sistemlere entegre edilen ücretli veri akışlarıdır. Bu beslemeler, binlerce IOC ve TTP bilgisini yüksek hacimde sunabilir.
        \item \textbf{Bilgi Paylaşım Toplulukları (ISACs):} Aynı sektördeki veya coğrafi bölgedeki organizasyonların tehdit istihbaratı paylaşımı için bir araya geldiği güvenilir platformlardır.
        \item \textbf{Dahili Kaynaklar:} Organizasyonun kendi güvenlik araçlarından (SIEM, EDR, IDS/IPS), ağ günlüklerinden, uç nokta telemetri verilerinden ve kimlik doğrulama kayıtlarından elde edilen verilerdir.
        \item \textbf{Derin ve Karanlık Web İzleme:} Gizli veya şifreli forumlar, siber suç pazarları ve sızdırılmış veri depolarından (örneğin, sızan kimlik bilgileri, saldırı planları) bilgi toplama.
    \end{itemize}
    \item \textbf{İşleme (Processing):} Toplanan ham verinin analiz edilebilir, yapılandırılmış ve temiz bir formata dönüştürüldüğü aşamadır. Bu, veri normalizasyonu (farklı formatlardaki verileri standartlaştırma), tekilleştirme (yinelenen kayıtları kaldırma), şifre çözme ve etiketleme işlemlerini içerir. Büyük veri kümeleri için otomasyon, bu aşamada hayati öneme sahiptir.
    \item \textbf{Analiz ve Yorumlama (Analysis and Interpretation):} İşlenmiş verinin anlamlı, eyleme dönüştürülebilir istihbarata dönüştüğü aşamadır. Analistler, kalıpları, eğilimleri, saldırı kampanyalarını ve potansiyel tehditleri belirlemek için verileri derinlemesine incelerler. Bu aşamada, insan uzmanlığı ve otomatik korelasyon mekanizmaları birleşir.
    \item \textbf{Yayma (Dissemination):} Analiz edilen istihbaratın ilgili paydaşlara zamanında ve uygun bir formatta sunulmasıdır. İstihbaratın formatı ve içeriği, hedef kitleye göre uyarlanmalıdır. Örneğin, CISO'lar için üst düzey yönetici brifingleri hazırlanırken, SOC analistleri için teknik IOC beslemeleri sunulur.
    \item \textbf{Geri Bildirim (Feedback):} Sürecin sürekli iyileştirilmesini sağlayan bu aşamada, istihbarat tüketicileri (örneğin, SOC analistleri), sunulan bilgilerin yararlılığı, alaka düzeyi ve doğruluğu hakkında geri bildirimde bulunur. Bu geri bildirim, bir sonraki döngüde daha iyi gereksinimlerin belirlenmesini ve istihbarat toplama stratejilerinin hassaslaştırılmasını sağlar.
\end{enumerate}

Bu yaşam döngüsü, bir organizasyonun reaktif tehdit algılama modelinden proaktif bir savunma duruşuna geçiş yapmasına olanak tanır. Bu sürekli ve döngüsel süreç, savunma mekanizmalarının saldırganların evrilen taktik, teknik ve prosedürlerine (TTP'ler) göre dinamik olarak ayarlanmasını sağlar. Bu dinamik adaptasyon, bir saldırganın bir sistemde kalma süresini (dwell time) doğrudan azaltır. Saldırganın sistemde kalma süresinin azalması, fidye yazılımı veya veri sızdırma gibi nihai hedeflere ulaşma şansını düşürürken, ihlalden kaynaklanan maliyetleri de önemli ölçüde azaltır. Bu sürekli öğrenme ve adaptasyon mekanizması, tehdit istihbaratı programının değerini ve etkinliğini katlanarak artırır.

\textbf{CTI Yaşam Döngüsü Aşamaları ve Uygulamaları}

\begin{tabularx}{\textwidth}{|l|X|X|X|}
\hline
\textbf{Aşama} & \textbf{Kısa Tanım} & \textbf{Hedef} & \textbf{Pratik Uygulama Örnekleri} \\
\hline
\textbf{Gereksinimler} & İhtiyaç duyulan istihbaratın belirlenmesi. & Kaynakları en kritik risklere odaklamak. & Finansal dolandırıcılık veya veri sızıntılarını hedef alan tehdit aktörlerinin TTP'leri hakkında bilgi toplama. \\
\hline
\textbf{Toplama} & Ham verinin farklı kaynaklardan alınması. & Tanımlanan gereksinimlere yönelik verileri toplama. & SIEM günlükleri, OSINT, karanlık web forumları, ticari tehdit beslemeleri, ISAC'ler. \\
\hline
\textbf{İşleme} & Toplanan ham veriyi analiz edilebilir formata getirme. & Veriyi yapılandırma, tekilleştirme ve zenginleştirme. & CSV dosyalarının normalizasyonu, VirusTotal'dan dosya karması zenginleştirme. \\
\hline
\textbf{Analiz} & İşlenmiş veriden eyleme dönüştürülebilir içgörüler çıkarma. & Tehditleri bağlamsallaştırma, kalıpları ve eğilimleri belirleme. & Bir oltalama kampanyasında kullanılan yeni bir tekniğin analizi. \\
\hline
\textbf{Yayma} & Elde edilen istihbaratı ilgili paydaşlara iletme. & Bilginin doğru kitleye, doğru zamanda ve doğru formatta sunulması. & C-seviyesi için yönetici brifingi, SOC analistleri için IoC beslemesi, otomatik güvenlik duvarı kuralı. \\
\hline
\textbf{Geri Bildirim} & İstihbaratın yararlılığı ve etkinliği hakkında geri bildirim toplama. & Sürekli iyileştirmeyi teşvik etme. & SOC ekibinden gelen istihbaratın yanlış pozitif oranına dair rapor, olay sonrası değerlendirme toplantıları. \\
\hline
\end{tabularx}

\subsection{Strategic, Tactical, Technical ve Operational Intelligence}

Siber tehdit istihbaratı, hedef kitlenin ihtiyaçlarına göre dört ana kategoriye ayrılır. Bu istihbarat türleri, bir organizasyonun savunma yeteneklerini tüm seviyelerde güçlendirmek için birlikte çalışır.

\begin{itemize}
    \item \textbf{Stratejik İstihbarat:} Genel tehdit ortamına ilişkin üst düzey bir bakış açısı sunar. Bu istihbarat, teknoloji dışı terimlerle hazırlanır ve öncelikli olarak üst düzey yöneticilere, CISO'lara ve risk yöneticilerine yöneliktir.
    \begin{itemize}
        \item \textbf{Amacı:} Güvenlik yatırımları, bütçe tahsisi ve kurumsal politikalar gibi uzun vadeli stratejik kararlara rehberlik etmektir.
        \item \textbf{Örnekler:} Bir APT grubunun bir sektörü veya belirli bir coğrafyayı hedeflemesi, fidye yazılımı eğilimleri veya jeopolitik olayların siber saldırı risklerine etkisi hakkında raporlar.
    \end{itemize}
    \item \textbf{Operasyonel İstihbarat:} Belirli bir tehdit aktörünün TTP'lerini, motivasyonlarını ve altyapısını anlamayı sağlar. Bu istihbarat, olay müdahale (IR) ekipleri ve tehdit avcıları için hayati öneme sahiptir.
    \begin{itemize}
        \item \textbf{Amacı:} Yaklaşan veya devam eden bir saldırının "kim, ne zaman, nerede, nasıl, neden" sorularına bağlamsal cevaplar sunmak. Bu, proaktif tehdit avcılığı ve olay müdahale planlaması için bir temel oluşturur.
        \item \textbf{Örnekler:} Bir saldırıda kullanılan belirli bir oltalama e-postası kampanyasının detayları veya bir Komuta ve Kontrol (C2) sunucusunun iletişim yöntemleri.
    \end{itemize}
    \item \textbf{Taktik İstihbarat:} Ağ ve uç noktalarda tehditleri tespit etmeye yardımcı olan, genellikle kısa ömürlü ve teknik göstergelerden oluşan bir istihbarat türüdür.
    \begin{itemize}
        \item \textbf{Amacı:} Otomatik tehdit tespiti için SIEM ve güvenlik duvarı gibi güvenlik kontrollerine entegre edilmek.
        \item \textbf{Örnekler:} Kötü amaçlı IP adresleri, dosya karmaları (hashes), kötü amaçlı alan adları.
    \end{itemize}
    \item \textbf{Teknik İstihbarat:} Taktik istihbaratın daha derin teknik detaylarını içerir ve genellikle kötü amaçlı yazılım analizi, tersine mühendislik ve IoC'lerin oluşturulmasını kapsar.
    \begin{itemize}
        \item \textbf{Amacı:} Saldırıların teknik işleyişini anlamak ve bu bilgilere dayanarak yeni imza tabanlı tespit kuralları oluşturmaktır.
    \end{itemize}
\end{itemize}

Bu dört istihbarat türü, birbirini besleyen ve destekleyen bir hiyerarşi içinde çalışır. Üst yönetim, genel güvenlik stratejisini belirlemek için stratejik istihbarata ihtiyaç duyar. Bu strateji, operasyonel ve taktiksel gereksinimlere dönüşür. Örneğin, stratejik istihbarat, jeopolitik gerilimlerin bir APT grubunun faaliyetlerini artıracağını gösterdiğinde, operasyonel ekip bu grubun TTP'lerini incelemeye odaklanır ve bu operasyonel bilgiler taktiksel IoC'lere dönüştürülerek güvenlik kontrollerine entegre edilir. Bu entegrasyon, istihbaratın tüm organizasyonel katmanlarda değer yaratmasını sağlar.

\textbf{İstihbarat Türleri Karşılaştırma Tablosu}

\begin{tabularx}{\textwidth}{|l|X|X|X|}
\hline
\textbf{Özellik} & \textbf{Stratejik} & \textbf{Operasyonel} & \textbf{Taktik} \\
\hline
\textbf{Hedef Kitle} & C-seviyesi yöneticiler, iş liderleri & Olay müdahale (IR) ekipleri, tehdit avcıları & SOC analistleri, güvenlik mühendisleri \\
\hline
\textbf{Odak Noktası} & Genel eğilimler, motivasyonlar, risk yönetimi & Saldırı kampanyaları, TTP'ler, saldırganın hedefleri & IOC'ler (IP, hash, alan adı), ağ etkinlikleri \\
\hline
\textbf{Zaman Çerçevesi} & Uzun vadeli (aylar, yıllar) & Orta vadeli (haftalar, aylar) & Kısa vadeli (gerçek zamanlı) \\
\hline
\textbf{Amaç} & Güvenlik yatırımlarını ve politikalarını belirleme & Saldırılara müdahale etme ve proaktif avcılık yapma & Otomatik tespit kuralları oluşturma ve tehditleri engelleme \\
\hline
\end{tabularx}

\subsection{Threat Actor Profiling ve Attribution Challenges}

Tehdit aktörü profilleme, saldırıların arkasındaki "kim" sorusuna cevap aramayı amaçlar. Bir tehdit aktörü profili, sadece bir isimden ibaret değildir; bir saldırganın kimliğini, hedeflerini, TTP'lerini, motivasyonlarını, coğrafi konumunu ve kullandığı altyapıyı kapsamlı bir şekilde analiz eder. Bu profiller, güvenlik ekiplerine saldırganın olası davranışları hakkında bir resim sunar ve savunma stratejilerini saldırganın niyetleriyle uyumlu hale getirmeye yardımcı olur.

Ancak, bir siber saldırıyı kesin olarak belirli bir tehdit aktörüne atfetmek (attribution), son derece karmaşık ve zorlu bir süreçtir. Bu zorlukların birkaç temel nedeni vardır:

\begin{itemize}
    \item \textbf{Gizleme ve Obfüskasyon:} Saldırganlar, kimliklerini gizlemek için çok sayıda katman kullanır. Botnetler, vekil sunucular ve kiralanmış altyapı, saldırının gerçek kaynağını maskeler. Özellikle dağıtık servis dışı bırakma (DDoS) saldırılarında, trafik binlerce farklı cihazdan gelebilir, bu da kesin bir atıf yapmayı neredeyse imkansız hale getirir.
    \item \textbf{Yanlış Bayrak Operasyonları:} Bazı siber suç grupları, dikkat çekmek veya yanlış bilgi yaymak amacıyla gerçekleştirmediği saldırıların sorumluluğunu üstlenebilir. Bu tür eylemler, atıf sürecini manipüle etmeyi amaçlar.
    \item \textbf{Araç ve TTP Paylaşımı:} Tehdit grupları, sıklıkla araç setlerini ve TTP'lerini birbirleriyle paylaşır veya değiştirir. Bir saldırıda kullanılan belirli bir teknik, daha önce bilinen bir grubun imzası olsa bile, başka bir grup tarafından da kullanılmış olabilir. Bu durum, yalnızca teknik IOC'lere dayalı atıf yapmanın güvenilirliğini azaltır.
\end{itemize}

Bu nedenle, atıf birincil hedef olmamalıdır. Bir saldırı meydana geldiğinde, ilk ve en acil öncelik, hasarı durdurmak, sistemleri güvence altına almak ve devam eden tehditleri ortadan kaldırmaktır. Atıf, bu acil riskler ortadan kaldırıldıktan sonra, olay sonrası analiz aşamasında daha sonraki savunmaları güçlendirmek için bir araç olarak ele alınmalıdır. Atıf, bir "evet/hayır" cevabı yerine, farklı güven seviyelerine sahip (düşük, orta, yüksek) analitik bir değerlendirme süreci olarak görülmelidir. Güvenilir bir atıf için, sadece IOC'ler yerine, davranışsal kanıtlar ve TTP'lere odaklanmak daha geçerli bir yaklaşımdır.

\subsection{Diamond Model ve Kill Chain Analysis}

Siber saldırıları anlamak ve analiz etmek için kullanılan iki önemli analitik çerçeve, Lockheed Martin'in Siber Kill Chain’i ve MITRE’nin Saldırı Analizinin Elmas Modeli’dir (Diamond Model of Intrusion Analysis). Bu modeller, saldırı sürecini farklı açılardan ele alarak birbirini tamamlar.

\begin{itemize}
    \item \textbf{Siber Kill Chain (Siber Saldırı Zinciri):} Bu model, bir saldırının yedi aşamalı, doğrusal bir sürecini sunar. Her aşama, bir saldırganın başarılı bir siber saldırı gerçekleştirmek için tipik olarak izlediği adımları tanımlar.
    \begin{enumerate}
        \item \textbf{Keşif (Reconnaissance):} Saldırgan, hedefin sistemleri, ağ yapısı ve çalışanları hakkında bilgi toplar.
        \item \textbf{Silahlandırma (Weaponization):} Bir exploit ve bir arka kapı (payload) bir araya getirilerek tek bir saldırı paketi oluşturulur.
        \item \textbf{Teslimat (Delivery):} Saldırı paketi, hedef sisteme iletilir (örneğin, oltalama e-postası veya kötü amaçlı web sitesi aracılığıyla).
        \item \textbf{İstismar (Exploitation):} Bir sistemdeki zafiyet kullanılarak ilk erişim elde edilir.
        \item \textbf{Kurulum (Installation):} Saldırgan, sistemde kalıcılığı sağlamak için arka kapıyı kurar.
        \item \textbf{Komuta ve Kontrol (Command and Control):} Saldırganın ele geçirilmiş sistemle uzaktan iletişim kurarak onu kontrol etmesini sağlar.
        \item \textbf{Hedefler Üzerindeki Eylemler (Actions on Objectives):} Saldırgan, veri sızdırma, sistem bozulması veya fidye gibi nihai hedeflerine ulaşır.
    \end{enumerate}
    Kill Chain, saldırıların nasıl ilerlediğine dair adım adım bir yol haritası sunar ve özellikle olay müdahalesi ve taktiksel savunma kararları için çok değerlidir.
    \item \textbf{Diamond Model of Intrusion Analysis (Saldırı Analizinin Elmas Modeli):} Bu model, siber saldırıları dört temel bileşen arasındaki ilişkilere odaklanarak inceler. Doğrusal bir model değildir, daha çok saldırının bütüncül bir resmini sunar.
    \begin{enumerate}
        \item \textbf{Saldırgan (Adversary):} Saldırının arkasındaki tehdit aktörü.
        \item \textbf{Kabiliyet (Capability):} Saldırganın kullandığı araçlar, teknikler ve yöntemler.
        \item \textbf{Altyapı (Infrastructure):} Saldırıyı desteklemek için kullanılan ağ altyapısı (örneğin, C2 sunucuları, vekil sunucular).
        \item \textbf{Kurban (Victim):} Saldırıya uğrayan kişi, organizasyon veya sistem.
    \end{enumerate}
    Elmas Modeli, tehdit istihbaratı ve proaktif tehdit avcılığı için daha kullanışlıdır. Saldırıdan elde edilen herhangi bir bilgi parçası (örneğin, bir C2 sunucusu), diğer üç bileşenle ilişkilendirilerek saldırganın potansiyel diğer faaliyetlerini ve gelecekteki olası hedeflerini tahmin etmek için kullanılabilir.
\end{itemize}

Kill Chain, bir saldırının \textit{nasıl} ilerlediğini detaylandırırken, Diamond Model saldırının \textit{neden} ve \textit{kim tarafından} yapıldığına dair daha geniş bir bakış açısı sunar. Bu modeller birbirini tamamlar. Bir saldırı tespit edildiğinde, Kill Chain modeli olayın taktiksel olarak yönetilmesine yardımcı olurken, Diamond Model olayın bileşenlerini analiz ederek bu olayı bilinen diğer tehdit gruplarıyla ilişkilendirmeyi ve gelecekteki potansiyel saldırıları tahmin etmeyi mümkün kılar.

\textbf{Kill Chain ve Diamond Model Karşılaştırma Tablosu}

\begin{tabularx}{\textwidth}{|l|X|X|}
\hline
\textbf{Özellik} & \textbf{Siber Kill Chain} & \textbf{Diamond Model} \\
\hline
\textbf{Odak Noktası} & Saldırı aşamaları ve süreci & Saldırgan, kabiliyet, altyapı ve kurban arasındaki ilişkiler \\
\hline
\textbf{Granülarite} & Daha spesifik ve doğrusal & Daha geniş, bağlamsal ve ilişkisel \\
\hline
\textbf{Uygulama Alanı} & Olay müdahalesi ve taktiksel savunma & Tehdit istihbaratı ve proaktif tehdit avcılığı \\
\hline
\textbf{Avantajlar} & Saldırıyı durdurmak için adım adım yol haritası sağlar & Saldırganın motivasyon ve kabiliyetlerini anlama olanağı sunar \\
\hline
\end{tabularx}

\subsection{Intelligence Requirements ve Priority Intelligence Requirements (PIR)}

İstihbarat gereksinimlerini tanımlamak, CTI yaşam döngüsünün ilk ve en önemli adımıdır. Priority Intelligence Requirements (PIR), bir organizasyonun en acil ve stratejik bilgi ihtiyaçlarını belirleyen, odaklanmış ve eyleme dönüştürülebilir sorulardır. PIR'ler, istihbarat toplama çabalarını yönlendirir ve kaynakların en kritik risklere odaklanmasını sağlar.

\textbf{Gereksinim Geliştirme Süreci (Senaryo Odaklı):}

Bir finansal kurumun siber güvenlik ekibinin, yeni bir dijital bankacılık platformu başlatmaya hazırlandığını varsayalım. Ekibin ve üst yönetimin temel endişesi, finans sektörünü hedef alan ve müşteri verilerini sızdırmayı amaçlayan saldırılarla ilgili riskleri proaktif olarak anlamaktır.

\begin{enumerate}
    \item \textbf{Stratejik Hedefleri Anlama:} Kuruluşun stratejik hedefi, yeni bir platformu başarıyla başlatmak ve müşteri güvenini korumaktır. Bu hedefle doğrudan ilişkili risk, veri sızıntıları ve finansal dolandırıcılık potansiyidir.
    \item \textbf{Risk Değerlendirmesi Yapma:} Kuruluşun en büyük riskleri, kimlik avı (phishing) saldırılarıyla kimlik bilgilerinin çalınması, sıfır gün (zero-day) zafiyetlerinin istismarı ve tedarik zincirine (supply chain) yönelik saldırılar olarak belirlenir.
    \item \textbf{PIR'leri Formüle Etme:} Bu riskler, belirli, tekil ve eyleme dönüştürülebilir sorulara dönüştürülür.
    \begin{itemize}
        \item \textbf{PIR 1:} "Son 6 ayda finans sektörünü hedef alan APT grupları tarafından en sık kullanılan kimlik avı TTP'leri nelerdir?"
        \item \textbf{PIR 2:} "Organizasyonumuzun tedarik zinciri içinde bulunan üçüncü taraf yazılımlar, bilinen APT grupları tarafından en sık istismar edilen zafiyetleri barındırmakta mıdır?"
        \item \textbf{PIR 3:} "Yeni dijital bankacılık platformumuzla ilgili olarak, derin ve karanlık webde hedef alınma niyetini gösteren herhangi bir tartışma veya plan var mıdır?"
    \end{itemize}
\end{enumerate}

Bu PIR'lar, istihbarat ekibine bir görev verir. Örneğin, PIR 1'i yanıtlamak için analistin sadece kimlik avı IOC'lerini toplamasını değil, aynı zamanda ilgili saldırıların davranışsal özelliklerini (örneğin, belirli bir spear-phishing tekniği, kullanılan araçlar) araştırmasını da gerektirir. Bu yaklaşım, toplanan verinin, organizasyonun gereksinimlerine göre filtrelenmesini ve analiz edilmesini zorunlu kılar, böylece istihbarat üretim süreci optimize edilir ve üretilen istihbarat daha yüksek bir değer taşır.

\textbf{PIR Geliştirme Şablonu}

\begin{tabularx}{\textwidth}{|l|X|X|}
\hline
\textbf{Stratejik Hedef} & \textbf{İlişkili Risk} & \textbf{PIR Sorusu} \\
\hline
Müşteri güvenliğini korumak ve veri sızıntılarını önlemek. & Müşteri veritabanına yetkisiz erişim. & "Finans sektörünü hedefleyen ve hassas müşteri verilerini çalan APT gruplarının bilinen TTP'leri nelerdir?" \\
\hline
Yeni dijital platformun güvenli bir şekilde başlatılması. & Platformun dış kaynaklı bileşenlerindeki zafiyetler. & "Dijital bankacılık platformumuzun kullandığı üçüncü taraf kütüphanelerde sıfır gün zafiyetleri hedefleyen saldırgan grupları var mıdır?" \\
\hline
Marka itibarını korumak ve dolandırıcılığı önlemek. & Oltalama (phishing) ve marka sahteciliği kampanyaları. & "Oltalama kampanyaları oluşturmak için en sık taklit edilen finansal markalar hangileridir ve bu kampanyalarda hangi teknikler kullanılmaktadır?" \\
\hline
\end{tabularx}

\section{Threat Intelligence Platforms ve Standards}

Tehdit İstihbarat Platformları (TIP'ler), siber tehdit istihbaratını toplamak, analiz etmek ve paylaşmak için kullanılan merkezi sistemlerdir. Bu platformlar, farklı kaynaklardan gelen tehdit verilerini bir araya getirir, bunları normalleştirir ve güvenlik ekiplerinin eyleme geçirilebilir istihbarat elde etmesini sağlar. Tehdit istihbaratı standartları ise, farklı sistemler ve kuruluşlar arasında tehdit bilgilerinin tutarlı bir şekilde paylaşılmasını sağlayan ortak formatlar ve protokollerdir.

\subsection{MITRE ATT\&CK Framework Integration}

MITRE ATT\&CK, saldırganların taktik, teknik ve prosedürlerini (TTP'ler) gerçek dünya gözlemlerine dayalı olarak kategorize eden küresel bir bilgi bankasıdır. Bu çerçeve, güvenlik profesyonellerine bir saldırının "nasıl" ve "neden" gerçekleştiğini anlamaları için ortak bir dil ve yapı sunar.

\begin{itemize}
    \item \textbf{Yapısal Analiz:} ATT\&CK, saldırgan davranışını hiyerarşik olarak düzenler:
    \begin{itemize}
        \item \textbf{Taktikler (Tactics):} Saldırganın yüksek seviyeli hedefleri (örneğin, İlk Erişim, Kalıcılık, Yan Hareket).
        \item \textbf{Teknikler (Techniques):} Taktiklere ulaşmak için kullanılan belirli yöntemler (örneğin, Kimlik Avı Bağlantısı, Uzaktan Hizmetler).
        \item \textbf{Prosedürler (Procedures):} Tekniklerin gerçek dünya saldırılarında nasıl uygulandığının somut örnekleri.
    \end{itemize}
    \item \textbf{Entegrasyon ve Uygulamalı Kullanım:}
    \begin{itemize}
        \item \textbf{Tehdit Modelleme:} ATT\&CK, bir saldırganın sistem içinde nasıl hareket edebileceğini haritalamak ve potansiyel saldırı yollarını görselleştirmek için kullanılır.
        \item \textbf{Savunma Boşluk Analizi:} Güvenlik kontrollerinin hangi teknikleri tespit edip engelleyebildiğini belirleyerek savunmadaki zayıf noktaları ortaya çıkarır. Bu analiz, güvenlik yatırımlarının doğru alanlara yönlendirilmesine yardımcı olur.
        \item \textbf{Tehdit Avcılığı:} Tehdit avcıları, hipotezlerini belirli ATT\&CK tekniklerine dayandırarak avlanma süreçlerini yapılandırabilir.
    \end{itemize}
    \item \textbf{Pratik Senaryo (TTP Analizi):} Bir saldırganın, bir yöneticinin kimlik bilgilerini çaldığını ve ağda yanal hareket ettiğini varsayalım.
    \begin{itemize}
        \item \textbf{Saldırı Olayı:} Yönetici, oltalama (phishing) e-postasıyla kötü amaçlı bir bağlantıya tıklar. Kimlik bilgileri çalınır. Saldırgan, bu kimlik bilgilerini kullanarak ağda başka bir sunucuya RDP (Uzak Masaüstü Protokolü) ile bağlanır.
        \item \textbf{ATT\&CK Eşleştirme:}
        \begin{itemize}
            \item \textbf{Taktik: Initial Access (İlk Erişim)} $\rightarrow$ \textbf{Teknik: Spearphishing Link (Kimlik Avı Bağlantısı)} (T1566.002).
            \item \textbf{Taktik: Credential Access (Kimlik Bilgisi Erişimi)} $\rightarrow$ \textbf{Teknik: OS Credential Dumping} (T1003) veya \textbf{Credential from Web Browsers} (T1555).
            \item \textbf{Taktik: Lateral Movement (Yan Hareket)} $\rightarrow$ \textbf{Teknik: Remote Services} (T1021) veya \textbf{Remote Desktop Protocol} (T1021.001).
        \end{itemize}
    \end{itemize}
\end{itemize}

ATT\&CK, güvenlik ekipleri için sadece bir teknik listesi olmaktan öteye geçer ve saldırgan davranışını standartlaştıran bir ortak dil haline gelir. Bu standardizasyon, farklı güvenlik birimleri (mavi takım, kırmızı takım, tehdit istihbaratı) arasındaki iletişimi kolaylaştırır. Olay müdahale planlarının ve otomatik yanıtların geliştirilmesini kolaylaştırır ve ekiplerin daha etkili bir şekilde işbirliği yapmasına olanak tanır. Bu çerçeve, güvenlik stratejisinin IOC'lere bağımlı olmaktan TTP'lere odaklanmaya kaymasını teşvik eder. Saldırganlar IP adresleri veya dosya karmaları gibi IOC'leri kolayca değiştirebilirken, yetki yükseltme veya kalıcılık elde etme yöntemleri (TTP'ler) daha kalıcı ve ayırt edicidir. Bu, daha uzun vadeli ve dayanıklı bir savunma sağlar.

\textbf{ATT\&CK Saldırı Eşleştirme Tablosu}

\begin{tabularx}{\textwidth}{|l|X|X|X|}
\hline
\textbf{Saldırı Aşaması} & \textbf{ATT\&CK Taktikleri} & \textbf{ATT\&CK Teknikleri} & \textbf{Örnek Davranış} \\
\hline
\textbf{İlk Erişim} & Initial Access & Spearphishing Link (T1566.002) & Yöneticinin oltalama e-postasına tıklaması. \\
\hline
\textbf{Keşif} & Discovery & Network Service Scanning (T1046) & Saldırganın ağda açık portları taraması. \\
\hline
\textbf{Kimlik Bilgisi Erişimi} & Credential Access & OS Credential Dumping (T1003) & Saldırganın bellekten parolaları çekmesi. \\
\hline
\textbf{Yan Hareket} & Lateral Movement & Remote Services (T1021) & Saldırganın çalıntı kimlik bilgileriyle bir RDP oturumu başlatması. \\
\hline
\textbf{Kalıcılık} & Persistence & Scheduled Task/Job (T1053.005) & Saldırganın gelecekteki erişim için zamanlanmış bir görev oluşturması. \\
\hline
\end{tabularx}

\subsection{STIX/TAXII Standards ve Information Sharing}

STIX ve TAXII, siber tehdit istihbaratını standart bir formatta paylaşmak ve otomatikleştirmek için geliştirilmiş uluslararası standartlardır. Bu standartlar, farklı platformlar ve organizasyonlar arasında kesintisiz bir bilgi akışı sağlayarak, tehdit istihbaratının değerini artırır.

\begin{itemize}
    \item \textbf{STIX (Structured Threat Information eXpression):} Tehdit istihbaratını tanımlamak için kullanılan JSON tabanlı, makine tarafından okunabilir bir dildir. STIX, saldırı motivasyonları, kabiliyetleri, IOC'ler ve TTP'ler gibi tehdit verilerini tutarlı bir şekilde ifade etmeyi sağlar.
    \item \textbf{TAXII (Trusted Automated eXchange of Intelligence Information):} STIX verilerinin güvenli ve otomatik olarak nasıl aktarılacağını tanımlayan bir protokoldir. TAXII, bir tehdit beslemesinden yeni istihbaratın çekilmesini (pull) veya itilmesini (push) mümkün kılar.
\end{itemize}

\textbf{Pratik Senaryo ve Örnek (Python):}
Bir tehdit istihbaratı beslemesinden alınan bir STIX nesnesinin Python'da nasıl oluşturulacağını gösteren basit bir örnek. Bu örnek, \texttt{stix2} kütüphanesini kullanarak bir \texttt{AttackPattern} nesnesinin nasıl oluşturulduğunu ve bir \texttt{ThreatActor}'e nasıl bağlandığını gösterebilir. Bu, STIX'in veriyi yapılandırmadaki rolünü vurgular.

\begin{verbatim}
import stix2
from stix2 import AttackPattern, ThreatActor

# Basit bir saldırı tekniği tanımlama
attack_pattern = stix2.AttackPattern(name="Kimlik Avı Bağlantısı",
    external_references=)

# Bir tehdit aktörü tanımlama
threat_actor = stix2.ThreatActor(name="Örnek Tehdit Aktörü",
    description="Finansal kazanç amaçlı faaliyet gösteren siber suç grubu.",
    aliases=)

# Saldırı tekniği ile tehdit aktörünü ilişkilendirme
relationship = stix2.Relationship(relationship_type="uses",
    source_ref=threat_actor.id,
    target_ref=attack_pattern.id)

# Nesneleri bir pakete ekleme
bundle = stix2.Bundle(attack_pattern, threat_actor, relationship)

print(bundle.serialize(pretty=True))

\end{verbatim}

Bu örnek, STIX'in veriyi sadece bir liste olarak değil, aynı zamanda ilişkileri ve bağlamı ile birlikte yapılandırmadaki önemini gösterir. Bu standartlar sayesinde, istihbarat paylaşımı manuel yöntemlerden (e-posta, PDF raporları) makine tarafından okunabilir ve otomatikleştirilebilir bir sürece taşınır, bu da reaksiyon süresini önemli ölçüde kısaltır ve güvenlik operasyonlarının verimliliğini artırır.

\subsection{Threat Intelligence Platform (TIP) Selection ve Implementation}

Tehdit istihbaratı platformları (TIP), çeşitli kaynaklardan gelen tehdit verilerini merkezileştiren, işleyen ve eyleme dönüştürülebilir istihbarata dönüştüren yazılımlardır. Bir TIP'nin değeri, topladığı ham veri miktarından ziyade, bu verileri güvenlik ekibine eyleme dönüştürülebilir bir şekilde sunma yeteneğiyle ölçülür.

\textbf{Seçim ve Uygulama Kılavuzu:}

\begin{enumerate}
    \item \textbf{Gereksinimleri Tanımlama:} Organizasyonun hangi istihbarat türlerine (stratejik, taktik, operasyonel) en çok ihtiyaç duyduğunu belirleyin. Bir olay müdahale ekibinin öncelikleri, üst yönetimin önceliklerinden farklıdır.
    \item \textbf{Mevcut Ortamı Değerlendirme:} Hangi SIEM/SOAR platformlarının, EDR çözümlerinin ve veri kaynaklarının mevcut olduğunu değerlendirin. TIP'nin mevcut altyapı ile entegrasyonu, operasyonel verimlilik için kritik öneme sahiptir.
    \item \textbf{TIP Seçimi:} Birden fazla istihbarat türünü entegre edebilen, iyi API ve bağlayıcılara sahip ve geniş bir veri kapsamı sunan bir platform arayın. Yalnızca göstergelere dayalı bir platform, sofistike ve sürekli değişen tehdit ortamına karşı yetersiz kalır. Gerçek değer, saldırganın motivasyonunu, kabiliyetini ve TTP'lerini anlamak için verileri bağlamsallaştıran platformlardan gelir.
    \item \textbf{Veri Alımını Yapılandırma:} Dahili ve harici beslemelerden (örneğin, ticari beslemeler, OSINT, dahili günlükler) veri alımını ayarlayın ve bu verileri standart bir formata dönüştürecek normalizasyon kurallarını oluşturun.
    \item \textbf{İş Akışlarını ve Otomasyon Kurallarını Oluşturma:} Tehditlerin nasıl önceliklendirileceği, zenginleştirileceği ve diğer güvenlik araçlarına nasıl aktarılacağı için otomasyon kuralları oluşturun. Bu, olay müdahale süreçlerini hızlandırır.
    \item \textbf{Test ve Optimizasyon:} Uçtan uca iş akışlarını gerçek dünya senaryolarıyla test edin ve geri bildirimlerle sistemi sürekli optimize edin.
\end{enumerate}

Saldırganlar, kullandıkları araçları ve altyapıyı hızla değiştirebildiğinden, yalnızca dosya karmaları ve IP adresleri gibi IOC'leri takip eden bir TIP, yeni veya bilinmeyen tehditlere karşı yetersiz kalır. Bir TIP'nin gerçek değeri, veriyi bağlamsallaştırma ve saldırgan davranışını anlama yeteneğinden gelir.

\subsection{Indicators of Compromise (IOC) Management}

Indicators of Compromise (IOC), bir sistemin veya ağın tehlikeye atıldığının dijital kanıtıdır. IOC'ler, bir saldırının "olduğunu" gösteren adli kanıtlardır ve olay sonrası adli analizler için çok değerlidir.

\begin{itemize}
    \item \textbf{Yaygın IOC Örnekleri:}
    \begin{itemize}
        \item \textbf{Ağ Trafiği Anormallikleri:} Normalin dışında giden ağ trafiği veya olağandışı port ve protokol kullanımı.
        \item \textbf{Kimlik Bilgisi Anomalileri:} Olağandışı saatlerde veya coğrafyalardan gelen oturum açma denemeleri.
        \item \textbf{Dosya Karmaları (Hashes):} Bilinen kötü amaçlı yazılım dosyalarının benzersiz SHA256 veya MD5 karmaları.
        \item \textbf{Sistem Değişiklikleri:} Şüpheli kayıt defteri (registry) veya sistem dosyası değişiklikleri.
    \end{itemize}
\end{itemize}

\textbf{Yönetim ve Playbook Örneği:}
Bir tehdit istihbaratı beslemesinden yeni bir IOC alındığında, otomatik bir playbook tetiklenebilir. Bu otomasyon, güvenlik ekiplerinin reaksiyon süresini önemli ölçüde kısaltır ve insan hatasını azaltır.

\textbf{Senaryo:} Yeni bir oltalama alan adı (domain) IOC olarak alınmıştır.

\begin{enumerate}
    \item \textbf{Tetkikleme:} TIP, yeni alan adını alır ve otomatik olarak risk puanı atar.
    \item \textbf{Zenginleştirme:} SOAR platformu, bu alan adını VirusTotal gibi kaynaklarda sorgulayarak ek bağlam (ilgili IP adresleri, diğer kötü amaçlı yazılım kampanyaları) toplar.
    \item \textbf{Otomatik Yanıt:} Bu alan adı yüksek riskli olarak işaretlendiğinde, SOAR platformu otomatik olarak güvenlik duvarlarına ve ağ filtreleme çözümlerine bu alanı engelleme talimatı gönderir.
    \item \textbf{Uyarı ve Eşleştirme:} SIEM'de bu IOC ile ilgili geçmiş günlükler taranır ve ilgili tüm olaylara bir uyarı gönderilir. Tespit edilen her olay, bir SOC analisti için otomatik olarak bir olay bileti oluşturur.
\end{enumerate}

IOC'ler, bir saldırının \textit{olduğunu} gösterirken, saldırı göstergeleri (Indicators of Attack - IoA), bir saldırının \textit{muhtemelen olacağını} gösterir. Bu ayrım, reaktif güvenlikten (olay sonrası) proaktif güvenliğe (olay öncesi) geçişin anahtarıdır. Örneğin, bir kullanıcının olağan dışı sayıda başarısız oturum açma denemesi yapması bir IoA'dır ve bu, daha erken bir aşamada müdahale edilerek saldırıyı önleme fırsatı sunar.

\subsection{Tactics, Techniques, and Procedures (TTP) Analysis}

TTP'ler, saldırganların hedeflerine ulaşmak için kullandıkları yöntemleri detaylandıran temel bileşenlerdir ve bir saldırının "hikayesini" anlatır.

\begin{itemize}
    \item \textbf{TTP Analizinin Önemi:}
    \begin{itemize}
        \item \textbf{Gelişmiş Tehdit Tespiti:} TTP'ler, geleneksel imza tabanlı tespit yöntemlerini atlatmaya çalışan karmaşık saldırıları tespit etmeye yardımcı olur.
        \item \textbf{Proaktif Savunma:} Saldırgan davranışını anlayarak, kuruluşlar doğrudan bu saldırı yöntemlerini hedef alan güvenlik kontrollerini uygulayabilir.
        \item \textbf{Saldırgan Atfı:} Belirli TTP'lerin benzersiz kombinasyonları, bir saldırının arkasındaki tehdit aktörünü belirlemek için bir ipucu olabilir.
    \end{itemize}
    \item \textbf{Uygulamalı Analiz Adımları:}
    \begin{enumerate}
        \item \textbf{Olayı TTP'lerle Eşleştirme:} Tespit edilen bir saldırının her adımını (örneğin, ilk erişim, kalıcılık) ATT\&CK çerçevesindeki ilgili Taktik ve Tekniklerle eşleştirin.
        \item \textbf{Davranışsal Anomali Tespiti:} Bu TTP'leri gerçekleştirmek için kullanılan davranışları (örneğin, bir yöneticinin normalde kullanmadığı bir komutu çalıştırması) belirleyin.
        \item \textbf{Özel Algılama Kuralları Oluşturma:} Bu davranışları tespit etmek için SIEM sistemlerinde veya EDR çözümlerinde özel kurallar oluşturun.
    \end{enumerate}
\end{itemize}
\textbf{SIEM Kural Örneği:} Bir saldırganın \texttt{whoami.exe} komutunu kullanarak yetki yükseltmeye çalıştığını varsayalım. \texttt{index=winlogs sourcetype=WinEventLog:Security EventCode=4688 "CommandLine"=*whoami.exe* | stats count by user, host | sort -count}. Bu basit sorgu, bir saldırganın "keşif" (discovery) taktiğini kullandığını gösterir ve daha fazla araştırma için bir başlangıç noktası sunar.

TTP analizi, geleneksel güvenlik yöntemlerinin sadece "ne oldu?" sorusuna odaklandığı durumlarda, bir saldırının "nasıl" ve "neden" yapıldığını anlamamızı sağlar. Bu, güvenlik ekiplerinin sadece reaktif olarak yanıt vermek yerine, bir sonraki adımı tahmin ederek proaktif bir savunma stratejisi geliştirmesini mümkün kılar.

\textbf{TTP Odaklı Tespit Kuralı Geliştirme Tablosu}

\begin{tabularx}{\textwidth}{|l|X|X|}
\hline
\textbf{Taktik / Teknik} & \textbf{İlişkili Davranışsal Anomali} & \textbf{Örnek SIEM Sorgusu (Splunk)} \\
\hline
\textbf{Lateral Movement (Yan Hareket)} & Kullanıcının normalde erişmediği bir sunucuda oturum açması. & \texttt{index=winlogs sourcetype=WinEventLog:Security EventCode=4624 AND Logon\_Type=3} \texttt{NOT user="*\$" | stats count by user, host, src\_ip | sort -count} \\
\hline
\textbf{Credential Access (Kimlik Bilgisi Erişimi)} & \texttt{lsass.exe} bellek dökümü almaya çalışan bir süreç. & \texttt{index=winlogs sourcetype=WinEventLog:Microsoft-Windows-Sysmon/Operational EventCode=10} \texttt{AND TargetImage="C:\textbackslash Windows\textbackslash System32\textbackslash lsass.exe"} \\
\hline
\textbf{Defense Evasion (Savunma Atlatma)} & \texttt{rundll32.exe} ile olağan dışı bir DLL'in çalıştırılması. & \texttt{index=winlogs sourcetype=WinEventLog:Security EventCode=4688} \texttt{AND ParentProcess="C:\textbackslash Windows\textbackslash System32\textbackslash rundll32.exe"} \texttt{AND CommandLine!="*\"C:\textbackslash Windows\textbackslash System32\textbackslash shell32.dll\"*"} \\
\hline
\end{tabularx}

\section{Threat Hunting Methodologies ve Techniques}

Tehdit avcılığı (threat hunting), bir kuruluşun ağında ve sistemlerinde, geleneksel güvenlik araçları tarafından tespit edilemeyen gizli tehditleri proaktif olarak arama sürecidir. Tehdit avcıları, bir ihlalin zaten gerçekleştiği varsayımıyla hareket ederler ve saldırganların izlerini bulmak için çeşitli analitik teknikler ve araçlar kullanırlar. Bu süreç, reaktif bir olay müdahale yaklaşımından daha proaktif bir savunma duruşuna geçişi temsil eder.

\subsection{Hypothesis-driven Threat Hunting Approaches}

Hipotez tabanlı tehdit avcılığı, rastgele veri arama süreçleri yerine, belirli bir teori veya varsayıma dayalı olarak tehdit arama sürecini yönlendirir. Bu yaklaşım, tehdit avcılarının çabalarını daha verimli ve amaç odaklı hale getirir.

\textbf{Hipotez Oluşturma Adımları:}

\begin{enumerate}
    \item \textbf{Tehdit İstihbaratına Dayalı Hipotez:} Güvenilir bir tehdit beslemesinden, sektörünüzü hedefleyen yeni bir fidye yazılımı grubunun kullandığı TTP'lerle ilgili bilgi edindiğinizi varsayın. Saldırganlar, kalıcılık için Windows Kayıt Defteri (Registry) çalıştırma anahtarlarını değiştirmeye çalışıyor olabilir.
    \item \textbf{Senaryo Geliştirme:} "Bir saldırgan, kimlik avı yoluyla elde ettiği kimlik bilgilerini kullanarak ağımızda yanal hareket ediyor ve kalıcılık için kayıt defterini manipüle ediyor olabilir".
    \item \textbf{Veri Kapsamını ve Sorgu Planını Belirleme:} Bu hipotezi test etmek için, uç nokta (endpoint) günlüklerinden Windows Kayıt Defteri değişikliklerini izleyen verileri toplayın ve yetki yükseltme olaylarına odaklanın.
\end{enumerate}

\textbf{Pratik Senaryo ve Örnek (Splunk/SIEM Sorgusu):}

\begin{itemize}
    \item \textbf{Hipotez:} "Bir saldırgan, yetki yükseltme taktiği olarak \texttt{whoami.exe} gibi sistem araçlarını kullanıyor."
    \item \textbf{Sorgu Planı:} Olağandışı bir sürecin \texttt{whoami.exe} komutunu çalıştırmasını arayın.
    \item \textbf{Örnek Splunk Sorgusu:}
    \begin{verbatim}
    index=winlogs sourcetype="WinEventLog:Security" EventCode=4688 
    NOT (ParentProcess="C:\\Windows\\System32\\cmd.exe" 
    OR ParentProcess="C:\\Windows\\System32\\powershell.exe") 
    AND process_name="whoami.exe" | stats count by user, host, ParentProcess | where count > 10
    \end{verbatim}
\end{itemize}

Bu sorgu, bir komut satırı veya PowerShell süreci tarafından başlatılmayan, anormal bir şekilde çok sayıda \texttt{whoami.exe} çalıştırma olayını arar. Bu, bir saldırganın savunma mekanizmalarını atlatmak için sıradışı bir süreçten bilgi toplama (discovery) tekniği kullandığını gösterebilir.

Hipotez tabanlı avcılık, bir SOC'u reaktif bir uyarı işleme biriminden, proaktif bir soruşturma gücüne dönüştürür. Bu, güvenlik ekiplerinin sürekli olarak gelen alarmları incelemek yerine, bir saldırının muhtemel yolunu varsayarak, otomatik sistemlerin gözden kaçırdığı davranışları aktif olarak aramalarını sağlar. Bu yaklaşım, güvenlik operasyonlarının stratejik olgunluğunu artırır ve analistlerin daha verimli çalışmasına olanak tanır.

\subsection{Data-driven Hunting ve Statistical Analysis}

Veri odaklı avcılık, belirli bir hipotez olmadan büyük veri kümelerindeki anormallikleri veya aykırı değerleri (outliers) bulmak için istatistiksel ve makine öğrenimi yöntemlerini kullanır. Bu yaklaşım, "bilinmeyen-bilinmeyenleri" (unknown-unknowns) bulmaya odaklanır.

\textbf{Teknikler:}

\begin{itemize}
    \item \textbf{Yığınlama (Stack Counting):} Belirli bir veri alanındaki değerlerin frekansını hesaplar ve bu sayede nadir veya yaygın görülen davranışları belirler. Örneğin, bir organizasyon içindeki tüm uç noktalardan belirli bir komutun kaç kez çalıştırıldığını saymak, nadir kullanılan ikili dosyaları ortaya çıkarabilir.
    \item \textbf{Kümeleme (Clustering):} İlgili veri noktalarını belirli kriterlere göre gruplara ayırır. Bu, normal davranışa ait kümelerden önemli ölçüde sapan, anormal davranışları belirlemeye yardımcı olur. Bu teknik, saldırganların "yaşadığı yeri kullanma" (Living-off-the-Land) tekniklerini veya bilinmeyen bir kötü amaçlı yazılımı gizlemek için kullandığı nadir komutları tespit etmek için etkilidir.
    \item \textbf{Korelasyon:} İki veya daha fazla veri seti arasındaki ilişkileri arar. Örneğin, bir kullanıcının olağan dışı saatlerde oturum açmasıyla aynı anda gerçekleşen bir veri alma hacmindeki ani artışı korele edebilir.
\end{itemize}

\textbf{Pratik Senaryo ve Örnek (Elastic/SIEM Sorgusu):}

\begin{itemize}
    \item \textbf{Senaryo:} Organizasyondaki tüm uç noktalarda yürütülen en nadir süreçleri analiz etmek.
    \item \textbf{Sorgu (Elastic Query Language - EQL):}
    \begin{verbatim}
    process where event.action: "process_started" | rare process.executable.name top=100
    \end{verbatim}
\end{itemize}

Bu sorgu, ağdaki en nadir yürütülebilir dosyaları belirler. Normalde bir sunucu grubunda görülmemesi gereken bir \texttt{.exe} dosyasının çalıştırılması gibi anormal süreçleri ortaya çıkarabilir. Bu, bir saldırganın gizlenmek için kullandığı sıradışı araçları veya yöntemleri tespit etmeye yardımcı olur.

Veri odaklı avcılık, yeni saldırı teknikleri veya daha önce görülmemiş kötü amaçlı yazılımlar gibi, önceden tanımlanmış bir hipotez oluşturmanın zor olduğu durumlerde devreye girer. Bu yöntem, analistlerin daha sonra bir hipotez geliştirebileceği şüpheli aktivitelere odaklanmasını sağlar.

\subsection{Behavioral Analytics ve Anomaly Detection}

Davranışsal analiz, kullanıcı ve sistem davranışlarını zaman içinde izleyerek kötü niyetli faaliyetleri gösterebilecek anlamlı kalıpları belirlemeyi amaçlar. İmza tabanlı güvenlik çözümlerinin kaçırdığı tehditleri (örneğin, sıfır gün zafiyetleri ve dosyasız kötü amaçlı yazılımlar) tespit etmede önemli bir boşluğu doldurur.

\textbf{Nasıl Çalışır:}

\begin{enumerate}
    \item \textbf{Davranışsal Taban Çizgisi (Baseline) Oluşturma:} Bir kullanıcının veya sistemin normal davranışını (örneğin, bir kullanıcının mesai saatlerinde ve coğrafi konumundan oturum açması) belirlemek için geçmiş verileri kullanır.
    \item \textbf{Anomali Tespiti:} Gerçek zamanlı aktiviteleri bu taban çizgisiyle karşılaştırır. Normalden sapmalar anomali olarak işaretlenir (örneğin, bir hesabın gece 3'te alışılmadık bir ülkeden oturum açması).
    \item \textbf{Risk Puanlaması:} Anormalliklere, potansiyel tehlike düzeyini belirlemek için dinamik risk puanları atanır.
\end{enumerate}

\textbf{Uygulama Alanları:}

\begin{itemize}
    \item \textbf{İç Tehditlerin Tespiti:} Bir çalışanın normalde erişmediği sistemlere veya verilere erişmeye çalışması gibi olağan dışı davranışları tespit eder.
    \item \textbf{Gelişmiş Kalıcı Tehdit (APT) Tespiti:} APT'ler yavaş hareket ettiğinden ve normal davranışlarla gizlendiğinden, davranışsal analiz bu uzun vadeli ve ince kalıpları ortaya çıkarabilir.
    \item \textbf{Kimlik Bilgisi Hırsızlığı:} Güvenlik altyapısına yetkili bir kullanıcı gibi göründükleri için mevcut araçları atlatabilen, çalınmış kimlik bilgilerini kullanan saldırganları yakalar.
\end{itemize}

Davranışsal anomali tespiti, yanlış pozitifler (false positives) gibi zorluklar taşısa da, bu yaklaşım dinamik olarak normal faaliyetin tanımını ayarlayarak ve risk puanlarını kullanarak gereksiz uyarıları azaltmaya çalışır. Bu sayede, analistlerin gerçek tehditlere odaklanmasını sağlar ve analist yorgunluğunu azaltır.

\textbf{Anomali Tespiti Türleri ve Örnekleri}

\begin{tabularx}{\textwidth}{|l|X|X|}
\hline
\textbf{Anomali Türü} & \textbf{Tanım} & \textbf{Siber Güvenlik Örneği} \\
\hline
\textbf{Nokta (Point) Anomalisi} & Veri setindeki tek bir noktanın normalden büyük ölçüde sapması. & Bir kullanıcının birden fazla başarısız oturum açma denemesinden sonra aniden başarılı olması. \\
\hline
\textbf{Bağlamsal (Contextual) Anomali} & Bir verinin, belirli bir bağlam veya durum altında anormal olması. & Bir kullanıcının normal mesai saatlerinde sık sık eriştiği bir sunucuya gece yarısı erişmesi. \\
\hline
\textbf{Kolektif (Collective) Anomali} & Bireysel olarak normal görünen bir dizi verinin, birlikte anormal bir desen oluşturması. & Bir DDoS saldırısında olduğu gibi, normal görünen küçük veri akışlarının birleşerek anormal bir trafiği oluşturması. \\
\hline
\end{tabularx}

\subsection{Hunt Team Organization ve Skill Development}

Etkili bir tehdit avcılığı programı, sadece doğru araçlardan ibaret değildir; aynı zamanda doğru becerilere sahip, iyi organize olmuş ve proaktif bir güvenlik ekibini gerektirir. Tehdit avcılığı, bir organizasyonun güvenlik duruşunun olgunluğunu gösterir ve onu reaktif bir yaklaşımdan, aktif ve insan liderliğindeki bir savunma stratejisine taşır.

\begin{itemize}
    \item \textbf{Gerekli Beceriler:}
    \begin{itemize}
        \item \textbf{Saldırgan Zihniyeti:} Tehdit avcıları, potansiyel saldırı yollarını ve zafiyetleri anlamak için bir saldırganın bakış açısını benimsemelidir.
        \item \textbf{Derin Veri Analizi:} Büyük veri kümelerini analiz etme, korelasyonları bulma ve istatistiksel yöntemleri uygulama yeteneği.
        \item \textbf{Teknik Uzmanlık:} İşletim sistemleri, ağ protokolleri, SIEM, EDR ve saldırı teknikleri hakkında derinlemesine bilgi.
        \item \textbf{Programlama Bilgisi:} Otomasyon, özel sorgular oluşturma ve veri işleme için Python veya PowerShell gibi betik (scripting) dillerini kullanma becerisi.
    \end{itemize}
\end{itemize}

Tehdit avcılığı, genellikle SOC (Güvenlik Operasyon Merkezi) içinde ayrı bir fonksiyon olarak konumlandırılır veya olay müdahale ekibiyle yakın işbirliği içinde çalışır. Düzenli kırmızı takım tatbikatları ve adli analiz çalışmaları, tehdit avcılarının becerilerini geliştirmelerine yardımcı olur.

\subsection{Threat Hunting Metrics ve Success Measurement}

Bir tehdit avcılığı programının değerini kanıtlamak için, başarısını somut ve ölçülebilir metriklerle desteklemek gereklidir. Bu metrikler, güvenlik liderliğine programın yatırım getirisini (ROI) göstermeyi ve sürekli iyileştirmeyi sağlar.

\begin{itemize}
    \item \textbf{Önemli Metrikler:}
    \begin{itemize}
        \item \textbf{Proaktif Olarak Tespit Edilen Olay Sayısı:} Otomatik sistemler tarafından değil, avcılık faaliyetleri sonucunda bulunan olayların sayısıdır. Bu, programın değerini doğrudan gösterir.
        \item \textbf{İkamet Süresi (Dwell Time) Azaltılması:} Saldırının başlangıcından tespit edilmesine kadar geçen sürenin kısaltılmasıdır. Düşük ikamet süresi, saldırganın sistemde hasar verme şansını azaltır ve ihlal maliyetini doğrudan düşürür.
        \item \textbf{Ortalama Tespit Süresi (MTTD) ve Ortalama Yanıt Süresi (MTTR):} Bir tehdidin ne kadar sürede tespit edildiğini ve ne kadar sürede tamamen çözüldüğünü gösteren anahtar performans göstergeleridir.
        \item \textbf{Yanlış Pozitif Oranı:} Avcılık faaliyetleri sonucunda üretilen alarmların ne kadarının sahte olduğunu gösterir. Düşük bir yanlış pozitif oranı, analist yorgunluğunu azaltır ve SOC'un verimliliğini artırır.
        \item \textbf{Avlanma Başarısı Oranı:} Gerçek bir tehdit tespitiyle sonuçlanan hipotezlerin yüzdesidir. Bu, hipotez oluşturma sürecinin kalitesini gösterir.
    \end{itemize}
\end{itemize}

Bu metrikler, tehdit avcılığının sadece teknik bir faaliyet olmadığını, aynı zamanda finansal riski ve iş sürekliliğini doğrudan etkileyen stratejik bir iş yatırımı olduğunu kanıtlar.

\textbf{Tehdit Avcılığı Başarı Metrikleri Tablosu}

\begin{tabularx}{\textwidth}{|l|X|X|X|}
\hline
\textbf{Metrik} & \textbf{Tanım} & \textbf{Ölçüm Formülü} & \textbf{İş Değeri Katkısı} \\
\hline
\textbf{MTTD Azaltma} & Bir tehdidi tespit etmek için gereken ortalama süredeki düşüş. & (Önceki MTTD - Mevcut MTTD) / Önceki MTTD & Saldırganın ağda kalma süresini ve potansiyel hasarı azaltır. \\
\hline
\textbf{Yanlış Pozitif Azaltma} & Yanlış alarmlar nedeniyle harcanan analist süresindeki düşüş. & (Toplam Yanlış Pozitif Sayısı / Toplam Alarm Sayısı) * 100 & Analist yorgunluğunu önler ve SOC verimliliğini artırır. \\
\hline
\textbf{İkamet Süresi} & Saldırının başlangıcından tam olarak çözülmesine kadar geçen süre. & (Olayın Çözülme Tarihi - Saldırının Başlangıç Tarihi) & Doğrudan bir ihlalin finansal ve itibar maliyetini düşürür. \\
\hline
\textbf{Proaktif Olay Sayısı} & Otomatik sistemler tarafından değil, avcılık faaliyetleriyle bulunan tehdit sayısı. & Proaktif Tespitle Bulunan Olay Sayısı & Kuruluşun güvenlik duruşunun olgunluğunu gösterir. \\
\hline
\end{tabularx}

\section{Advanced Persistent Threat (APT) Detection}

Gelişmiş Kalıcı Tehditler (APT'ler), belirli bir hedefi uzun süre boyunca gizlice gözetlemek ve veri çalmak amacıyla tasarlanmış, sofistike ve hedefli siber saldırılardır. APT'ler, genellikle devlet destekli veya iyi finanse edilen suç grupları tarafından yürütülür. Bu saldırılar, geleneksel güvenlik önlemlerini atlatmak için özel olarak tasarlanmış kötü amaçlı yazılımlar ve karmaşık taktikler kullanır.

\subsection{APT Lifecycle ve Long-term Persistence Techniques}

APT saldırıları, genellikle uzun bir zaman dilimine yayılan ve hedeflerine ulaşmak için birden fazla aşamayı içeren karmaşık operasyonlardır. APT'lerin temel amacı, hızlı bir etki yaratmak yerine, veri sızdırma veya casusluk gibi uzun vadeli hedefler için sistemde kalıcılık sağlamaktır.

\textbf{APT Yaşam Döngüsü Aşamaları:}

\begin{enumerate}
    \item \textbf{Sızma (Infiltration):} Saldırgan, genellikle oltalama (phishing), sosyal mühendislik veya sıfır gün (zero-day) zafiyetlerini kullanarak ağa ilk erişimi kazanır.
    \item \textbf{Keşif ve Genişleme (Exploration and Expansion):} İlk erişimden sonra, saldırgan yanal hareket (lateral movement) ile ağın haritasını çıkarır, yetki yükseltir ve hassas verilere erişim arar. Bu aşamada, birden fazla giriş noktası sağlamak için arka kapılar kurulur.
    \item \textbf{Veri Sızdırma (Exfiltration):} Toplanan veriler, tespit edilmeden ağ dışına, C2 sunucularına aktarılır. Saldırganlar bu aşamada, güvenlik personelini oyalamak için DDoS gibi "beyaz gürültü" (white noise) olayları sahneleyebilir.
    \item \textbf{Kalıcılık (Maintenance):} Saldırganın ağdaki varlığını uzun süre boyunca gizli tutmasıdır. APT'lerin en ayırt edici özelliklerinden biridir ve bu aşamada kullanılan teknikler tespiti son derece zorlaştırır.
\end{enumerate}

\textbf{Uzun Süreli Kalıcılık Teknikleri:}

\begin{itemize}
    \item \textbf{Rootkit'ler:} Sistemin çekirdek seviyesine yerleşerek kötü amaçlı faaliyetleri ve dosyaları gizler.
    \item \textbf{Kayıt Defteri (Registry) Anahtarları:} Kötü amaçlı yazılımın sistem açılışında otomatik olarak başlatılması için kayıt defterindeki anahtarları değiştirir.
    \item \textbf{Zamanlanmış Görevler (Scheduled Tasks):} Zararlı bir betiği veya programı düzenli aralıklarla çalıştırmak için meşru zamanlanmış görevleri kötüye kullanır.
    \item \textbf{Dosyasız Kötü Amaçlı Yazılımlar (Fileless Malware):} Fiziksel bir dosyayı diske yazmadan doğrudan bellekte çalışan kötü amaçlı yazılımlardır.
\end{itemize}

APT'ler "düşük ve yavaş" (low and slow) tekniklerini kullandığı için, savunmanın IOC'leri aramaktan ziyade davranışsal anomalilere odaklanması gerekir. Bu, her bir eylemin bireysel olarak fark edilmeyecek kadar küçük olmasını sağlamayı hedefler.

\textbf{APT Yaşam Döngüsü ve İlişkili TTP'ler Tablosu}

\begin{tabularx}{\textwidth}{|l|X|X|}
\hline
\textbf{APT Yaşam Döngüsü Aşaması} & \textbf{Açıklama} & \textbf{İlişkili TTP'ler ve Teknikler} \\
\hline
\textbf{Sızma (Infiltration)} & Ağa ilk erişimin kazanılması. & Oltalama (Phishing), Sosyal Mühendislik, Sıfır Gün İstismarı. \\
\hline
\textbf{Keşif ve Genişleme} & Ağın haritalanması ve yetki yükseltilmesi. & Yanal Hareket, Kimlik Bilgisi Dökümü (Credential Dumping), Ağ Servis Tarama. \\
\hline
\textbf{Veri Sızdırma (Exfiltration)} & Hedeflenen verilerin ağ dışına çıkarılması. & DNS Tünelleme, Bulut Depolama Hizmetleri Kullanımı. \\
\hline
\textbf{Kalıcılık (Maintenance)} & Saldırganın ağdaki varlığının sürdürülmesi. & Rootkit'ler, Kayıt Defteri Değişiklikleri, Zamanlanmış Görevler. \\
\hline
\end{tabularx}

\subsection{Lateral Movement Detection ve Analysis}

Yanal hareket, bir saldırganın ağ içinde ilk erişim noktasından hassas verilere veya sistemlere doğru hareket etme sürecidir. Bu, bir saldırının APT yaşam döngüsündeki en kritik aşamalarından biridir, çünkü saldırgan bu sayede ağ içindeki en değerli varlıkları bulur.

\textbf{Tespit Yöntemleri ve Analiz (Pratik Örnekler):}

Yanal hareket, genellikle normal ağ trafiği veya yönetici faaliyetleri gibi görünmek için meşru araçları kötüye kullandığından, tespiti anomali analizine dayanır.

\begin{itemize}
    \item \textbf{Sysmon ve Windows Olay Günlükleri Analizi:}
    \begin{itemize}
        \item \textbf{Olay Kimliği (Event ID) 4624:} Başarılı ağ oturum açma olaylarını kaydeder. Olağandışı kaynak IP'lerden veya normalde o hesaba ait olmayan ana bilgisayarlardan gelen oturum açma girişimleri yanal hareketin bir göstergesi olabilir.
        \item \textbf{Olay Kimliği (Event ID) 4688:} Yeni bir sürecin (process) oluşturulduğu zaman kaydedilir. Saldırganların kullandığı \texttt{psexec} veya \texttt{wmiexec} gibi araçların süreç yaratma olaylarını takip etmek önemlidir.
        \item \textbf{Olay Kimliği (Event ID) 5140:} Bir ağ paylaşımına erişim sağlandığında tetiklenir. Özellikle hassas paylaşımlara (örneğin, yönetici paylaşımı) yapılan olağan dışı erişimleri izlemek hayati öneme sahiptir.
    \end{itemize}
\end{itemize}

\textbf{Pratik Senaryo ve Sorgu:}
Bir saldırganın, yetki yükseltme elde ettikten sonra, \texttt{psexec} kullanarak ağda yanal hareket etmeye çalıştığını varsayalım. Bu, genellikle standart bir hizmet olarak görünse de, yanal hareketin bir göstergesidir.

\textbf{Sorgu (Splunk/SIEM):}
\begin{verbatim}
index=winlogs sourcetype="WinEventLog:Security" EventCode=4688 
process_name="psexec.exe" | table _time, host, process_name, command_line
\end{verbatim}

Bu sorgu, \texttt{psexec.exe} çalıştıran tüm süreçleri arar. Çıktı, hangi ana bilgisayarda, ne zaman ve hangi komutlarla çalıştırıldığını göstererek, saldırganın yanal hareketini haritalamanıza olanak tanır. Bir saldırının tespiti, tek bir olaydan ziyade, bir dizi anormal olayın korelasyonuna dayanır. Örneğin, farklı makinelere art arda yapılan oturum açma girişimleri ve yetki yükseltme denemeleri, bir araya geldiğinde yüksek riskli bir kalıbı ortaya çıkarır.

\subsection{Living-off-the-Land Techniques Identification}

Living-off-the-Land (LotL) saldırıları, saldırganların hedef sistemdeki meşru araç ve işlevleri (LOLBins - Living-Off-the-Land Binaries) kötü niyetli amaçlar için kullanmasıdır. Bu saldırılar, zararlı bir dosya indirmek yerine, sistemde zaten var olan \texttt{PowerShell.exe} veya \texttt{wmic.exe} gibi yerleşik araçları kullanır, bu da geleneksel antivirüs ve imza tabanlı sistemleri atlatmada son derece etkili olmalarını sağlar.

\begin{itemize}
    \item \textbf{Yaygın LOLBins ve LOLScripts (Kötüye Kullanılan Meşru Araçlar):}
    \begin{itemize}
        \item \textbf{PowerShell:} Windows'un güçlü bir komut satırı ve betik dilidir. Saldırganlar, kötü amaçlı kod indirmek, yetki yükseltmek ve ağda yanal hareket etmek için kullanır.
        \item \textbf{WMI (Windows Management Instrumentation):} Sistem yönetim aracıdır. Saldırganlar, uzaktan komut çalıştırmak, bilgi toplamak ve kalıcılık sağlamak için kullanır.
        \item \textbf{Certutil:} Dosyaları indirmek ve kodlamak için kullanılır. Saldırganlar, kötü amaçlı yazılımları indirmek veya sızdırılan verileri (exfiltrated data) kodlamak için kullanabilir.
    \end{itemize}
\end{itemize}

\textbf{Tespit ve Örnek (PowerShell Analizi):}
Dosyasız (fileless) bir saldırıda, kötü amaçlı kod bellekte çalıştırıldığı için fiziksel bir dosya bırakmaz. Bu tür bir saldırıyı tespit etmek için PowerShell betik blok günlüğünü (Script Block Logging) etkinleştirmek ve bu günlükleri SIEM platformunda analiz etmek esastır.

\textbf{SIEM Kuralı Örneği:}
\begin{verbatim}
index=winlogs sourcetype="WinEventLog:Microsoft-Windows-PowerShell/Operational" 
AND (host.name=target_server AND 
(PowerShell_Script_Content="*IEX*" OR PowerShell_Script_Content="*Invoke-Expression*"))
\end{verbatim}

Bu kural, \texttt{Invoke-Expression} veya \texttt{IEX} gibi, uzaktan indirilen kodları bellekte çalıştırmak için sıkça kullanılan PowerShell komutlarını arar. Bu, bir saldırganın savunma mekanizmalarını atlatmaya çalıştığını gösterebilir. LotL teknikleri, saldırı ve savunma arasındaki "silahlanma yarışı"nı yeni bir seviyeye taşır. Savunucular, bu meşru araçların anormal bir şey yapıp yapmadığını belirlemek zorundadır.

\subsection{Command and Control (C2) Communication Analysis}

Komuta ve Kontrol (C2), bir saldırganın ele geçirdiği sistemlerle uzaktan iletişim kurarak komut göndermesi ve veri alması sürecidir. Modern C2 iletişimleri, tespitten kaçınmak için meşru trafik içinde gizlenir ve genellikle şifreleme, protokol taklidi (HTTP, HTTPS), bulut hizmetleri veya DNS tünelleme gibi teknikleri kullanır.

\textbf{DNS Tünelleme Analizi (Örnek Senaryo):}
DNS tünelleme, DNS istekleri ve yanıtları içinde kötü amaçlı verileri gizleme tekniğidir. Güvenlik duvarları genellikle DNS trafiğine güvendiği için etkili bir yöntemdir.

\textbf{Adım-Adım İşleyiş:}
\begin{enumerate}
    \item \textbf{Saldırgan Alan Adını Kaydeder:} Saldırgan, \texttt{kotusite.com} gibi bir alan adı kaydeder ve bu alan adını kendi kontrolündeki bir DNS sunucusuna yönlendirir.
    \item \textbf{Veriyi Kodlar ve DNS Sorgusu Gönderir:} Kurban makinesindeki kötü amaçlı yazılım, sızdırılacak veriyi (örneğin, çalınan kimlik bilgileri) bir alt alan adına (subdomain) kodlar. Örnek: \texttt{gizli.veriler.kotusite.com}.
    \item \textbf{Sorgu Saldırganın Sunucusuna Ulaşır:} Bu istek, standart DNS çözücülerinden geçer ve sonunda saldırganın sunucusuna ulaşır.
    \item \textbf{Yanıt Verisi Gönderir:} Saldırganın sunucusu, komutları kurban makinesine geri göndermek için DNS yanıtını kullanır.
\end{enumerate}

\textbf{Tespit Teknikleri:}
\begin{itemize}
    \item \textbf{Büyük Sorgu/Yanıt Boyutları:} Olağan dışı büyük boyutlar, veri sızdırmanın bir göstergesi olabilir.
    \item \textbf{Olağandışı DNS Kayıt Türleri:} Normalde kullanılmayan \texttt{TXT} veya \texttt{NULL} gibi kayıt türlerinin kötüye kullanımı.
    \item \textbf{Anormal İstek Sıklığı:} Bir ana bilgisayardan belirli bir alana çok sayıda, düzenli aralıklarla yapılan istekler.
\end{itemize}

Modern C2 teknikleri, geleneksel ağ savunmalarını atlatmak için "güvenilir" trafik türlerini (DNS, HTTPS) kullanır. Bu, ağ güvenliğinin sadece trafiği engellemekle kalmayıp, aynı zamanda trafiğin içeriğini ve davranışını da analiz etmesi gerektiğini vurgular.

\subsection{APT Attribution ve Threat Group Tracking}

Bir APT saldırısını belirli bir tehdit grubuna atfetmek, nadiren mümkün olan karmaşık ve kaynak yoğun bir süreçtir.

\textbf{Atıf Süreci:}

\begin{itemize}
    \item \textbf{Gözlemlenebilir Kanıtları Analiz Etme:} Süreç, saldırganın altyapısını, kurbanlarını ve TTP'lerini analiz ederek başlar.
    \item \textbf{Uzman Yorumu ve Güven Seviyeleri:} Analistler, ellerindeki verilere dayanarak bir atıf değerlendirmesi yapar ve bu değerlendirmeye bir güven seviyesi (örneğin, düşük, orta, yüksek) atarlar.
    \item \textbf{Çelişen Atıfları Yönetme:} Farklı güvenlik firmalarının aynı saldırıya farklı isimler vermesi, tutarlı bir atıf standardı oluşturmayı zorlaştırır.
\end{itemize}

Atıf, bir "evet/hayır" sorusu değildir, daha çok bir olasılık değerlendirmesi ve dinamik bir süreçtir. Saldırganlar taktiklerini değiştirdikçe veya yeni kanıtlar ortaya çıktıkça, bir atıf değerlendirmesi sürekli olarak yeniden gözden geçirilmelidir.

\textbf{APT Atıf Zorlukları Tablosu}

\begin{tabularx}{\textwidth}{|l|X|X|}
\hline
\textbf{Zorluk Türü} & \textbf{Açıklama} & \textbf{Pratik Örnek} \\
\hline
\textbf{Teknik Zorluklar} & Saldırganların izlerini gizlemek için kullandığı yöntemler. & Saldırganların saldırı için botnetler, kiralanmış altyapı veya farklı vekil sunucular kullanması. \\
\hline
\textbf{Organizasyonel Zorluklar} & Güvenlik firmaları arasındaki atıf isimlendirme tutarsızlıkları. & Aynı saldırıya farklı firmaların APT34 (PWC) veya Helix Kitten (Mandiant) gibi farklı isimler vermesi. \\
\hline
\textbf{Operasyonel Zorluklar} & TTP'lerin veya araçların farklı gruplar arasında paylaşılması. & Bir grubun belirli bir arka kapı veya exploit kodunu başka bir gruba satması veya takas etmesi. \\
\hline
\end{tabularx}

\section{Malware Analysis ve Reverse Engineering}

Kötü amaçlı yazılım analizi (malware analysis), bir kötü amaçlı yazılım örneğinin işlevselliğini, kökenini ve potansiyel etkisini anlamak için yapılan bir incelemedir. Tersine mühendislik (reverse engineering) ise, bir yazılımın veya sistemin nasıl çalıştığını anlamak için onu parçalarına ayırma sürecidir. Bu iki disiplin, siber güvenlik uzmanlarının yeni tehditleri anlamasına, savunma mekanizmaları geliştirmesine ve saldırıların arkasındaki aktörleri belirlemesine yardımcı olur.

\subsection{Static Malware Analysis Techniques ve Tools}

Statik analiz, kötü amaçlı yazılımı çalıştırmadan, kodunu, yapısını ve içindeki verileri incelemeyi içerir. Bu yöntem, malware hakkında ilk bilgileri hızlı bir şekilde elde etmek için kullanılır.

\textbf{Teknikler:}
\begin{itemize}
    \item \textbf{Dosya Parmak İzi (File Fingerprinting):} Dosyanın MD5 veya SHA256 gibi kriptografik bir karmasını (hash) oluşturur ve bu karmayı bilinen kötü amaçlı yazılım veritabanlarında sorgular.
    \item \textbf{Dizge (String) Analizi:} Bir ikili dosyadan okunabilir dizgeleri (IP adresleri, dosya yolları, komutlar) ayıklamak, saldırganın niyetine dair ipuçları verebilir.
    \item \textbf{İçe Aktarılan Fonksiyonları (Imports) İnceleme:} Dosyanın hangi Windows API'lerini çağırdığını kontrol etme, bu sayede dosyanın potansiyel işlevleri hakkında fikir edinme. Örneğin, \texttt{CreateRemoteThread} işlevi süreç enjeksiyonunu, \texttt{URLDownloadToFile} internetten dosya indirmeyi gösterebilir.
    \item \textbf{Decompiler ve Disassembler Kullanımı:} \texttt{Ghidra} gibi araçlar, makine kodunu daha okunabilir assembly diline veya C diline çevirerek analistlerin kodun işleyişini anlamasına yardımcı olur.
\end{itemize}

\textbf{Araçlar ve Pratik Kılavuz (Ghidra):}
\begin{itemize}
    \item \textbf{Ghidra:} NSA tarafından geliştirilen ücretsiz bir tersine mühendislik aracıdır.
    \item \textbf{Adım-Adım Kullanım:}
    \begin{enumerate}
        \item \textbf{Kurulum:} Java'nın kurulu olduğundan emin olun ve Ghidra'yı GitHub sayfasından indirin.
        \item \textbf{Proje Oluşturma:} Yeni bir proje oluşturun ve kötü amaçlı yazılım dosyasını içe aktarın.
        \item \textbf{Analiz:} Ghidra'nın dosyayı analiz etmesine izin verin.
        \item \textbf{İnceleme:} \texttt{İçe Aktarılanlar} (Imports) penceresinden API çağrılarını inceleyin. \texttt{Dizge} (Strings) penceresinden okunabilir dizgeleri arayın. \texttt{İşlev Grafiği} (Function Graph) ile kodun akışını görselleştirin.
    \end{enumerate}
\end{itemize}

Statik analiz, kötü amaçlı yazılımın potansiyel işlevleri hakkında hızlı bir genel bakış sağlar ancak, gizleme (obfuscation) ve paketleme (packing) teknikleri nedeniyle her zaman tam bir resim sunamaz.

\textbf{Statik Analiz Araçları ve Kullanım Alanları}

\begin{tabularx}{\textwidth}{|l|X|X|}
\hline
\textbf{Araç Adı} & \textbf{Tipi} & \textbf{Kullanım Alanı} \\
\hline
\textbf{Ghidra} & Tersine Mühendislik & Kod analizi, disassembly, decompilation, içe aktarılan fonksiyonların incelenmesi. \\
\hline
\textbf{strings} & Komut Satırı Aracı & Bir ikili dosyadan okunabilir ASCII ve Unicode dizgeleri ayıklama. \\
\hline
\textbf{md5sum/sha256sum} & Komut Satırı Aracı & Bir dosyanın kriptografik karmasını (hash) oluşturma ve bilinen veritabanlarında sorgulama. \\
\hline
\textbf{PEStudio} & Otomatik Statik Analiz & Bir PE (Portable Executable) dosyasının başlıklarını, içe aktarılanlarını ve dizgelerini hızlıca inceleme. \\
\hline
\end{tabularx}

\subsection{Dynamic Analysis ve Sandbox Environments}

Dinamik analiz, kötü amaçlı yazılımı kontrollü ve izole bir ortamda (sandbox) çalıştırarak gerçek zamanlı davranışını gözlemleme sürecidir. Bu yöntem, statik analizin atlatıldığı durumlarda kritik öneme sahiptir.

\begin{itemize}
    \item \textbf{Sandbox:} Bir kötü amaçlı yazılımı ana sistemden tamamen izole edilmiş bir sanal makinede (VM) veya konteynerde çalıştıran güvenli bir ortamdır. Amacı, kötü amaçlı yazılımın sistemde kalıcı değişiklikler yapmasını veya ağa yayılmasını engellemektir.
    \item \textbf{Cuckoo Sandbox (Pratik Kılavuz):} Cuckoo, açık kaynaklı, otomatik bir malware analiz platformudur.
    \begin{enumerate}
        \item \textbf{Yapılandırma:} Cuckoo, bir ana makine (host) ve bir veya daha fazla sanal makine (guest) içerir. Sanal makineler, kötü amaçlı yazılımı çalıştırmak için kullanılır ve ağları ana makineden izole edilir.
        \item \textbf{İşleyiş:} Analist, şüpheli bir dosyayı Cuckoo'ya gönderir. Platform, bu dosyayı sanal makinede çalıştırır ve şunları izler:
        \begin{itemize}
            \item Dosya sistemi değişiklikleri (yeni dosya oluşturma, silme).
            \item Kayıt defteri (registry) değişiklikleri.
            \item Ağ trafiği (C2 sunucularıyla iletişim, DNS istekleri).
            \item Süreç enjeksiyonu ve yetki yükseltme girişimleri.
        \end{itemize}
        \item \textbf{Raporlama:} Analiz tamamlandığında, Cuckoo, gözlemlenen davranışları ve toplanan IOC'leri (IP'ler, alan adları, dosya karmaları) içeren kapsamlı bir rapor oluşturur.
    \end{enumerate}
\end{itemize}

Dinamik analiz, imza tabanlı sistemlerin kaçırdığı sıfır gün (zero-day) tehditlerini ve polimorfik (polymorphic) kötü amaçlı yazılımları (imzalarını değiştiren) tespit etmede etkilidir, çünkü bir dosyanın içeriğinden ziyade yaptığı şeye odaklanır.

\subsection{Behavioral Analysis ve Family Classification}

Davranışsal analiz, kötü amaçlı yazılımları, gösterdikleri davranışsal kalıplara göre sınıflandırmanın temelidir. Bu sınıflandırma, yeni varyantlar ortaya çıktığında bile benzer davranışları paylaşan kötü amaçlı yazılımları bir araya getirmeyi sağlar.

\textbf{Sınıflandırma Süreci:}
\begin{enumerate}
    \item \textbf{Davranış İzleme:} Kötü amaçlı yazılım örneği, bir sandbox ortamında çalıştırılırken, yaptığı tüm eylemler (API çağrıları, dosya değişiklikleri, ağ bağlantıları) kaydedilir.
    \item \textbf{Özellik Çıkarma:} Bu eylemlerden, dosya açma, mutex'leri kilitleme veya belirli kayıt defteri anahtarlarını ayarlama gibi davranışsal özellikler çıkarılır.
    \item \textbf{Makine Öğrenimi ile Kümeleme:} Makine öğrenimi algoritmaları, benzer davranışsal kalıpları paylaşan kötü amaçlı yazılımları aynı aileye gruplar. Bu kümeleme, bilinen bir ailenin yeni varyantlarını tanımlamaya yardımcı olur.
\end{enumerate}

Bir kötü amaçlı yazılımın hangi aileye ait olduğunu anlamak, onun potansiyelini (ne yapabileceğini), hedeflerini ve kökenini anlamamıza yardımcı olur ve tehdit aktörü atfı için önemli bir köprü görevi görür.

\subsection{Anti-analysis Evasion Techniques}

Kötü amaçlı yazılım yazarları, analizden kaçınmak ve tespit edilme sürelerini uzatmak için çeşitli teknikler kullanır. Bu teknikler, statik ve dinamik analiz araçlarını atlatmayı amaçlar.

\textbf{Kaçınma (Evasion) Teknikleri:}
\begin{itemize}
    \item \textbf{Sandbox Tespiti:} Kötü amaçlı yazılım, bir sanal ortamda (VM) çalışıp çalışmadığını kontrol eder. Örneğin, belirli sanallaştırma sürücülerinin varlığını kontrol edebilir veya sistem özelliklerini (bellek boyutu, ekran çözünürlüğü) test edebilir. Bir sandbox tespit edilirse, kötü amaçlı yazılım zararsız bir şekilde sonlanabilir veya zararsız bir davranış sergileyebilir.
    \item \textbf{Zamana Bağlı Gecikme:} Kötü amaçlı yazılım, kötü niyetli faaliyetlerini, ortamın bir insan kullanıcısının etkileşimiyle geçen bir zaman dilimi içinde olduğunu teyit edene kadar geciktirir.
    \item \textbf{Statik Analizden Kaçınma:} Kod karmaşıklaştırma (obfuscation), paketleme (packing) veya sahte komutlarla disassembler'ları yanıltma.
\end{itemize}

\textbf{Karşı Önlemler:}
\begin{itemize}
    \item \textbf{Gelişmiş Sandbox'lar:} Sanal ortamların gerçek sistemler gibi görünmesini sağlayarak sandbox tespit tekniklerini atlatır.
    \item \textbf{Davranışsal Analiz:} Kötü amaçlı yazılımın statik imzasını değil, davranışını analiz eder ve zararsız görünen ancak aniden kendini sonlandıran bir dosyanın davranışını kaydeder.
\end{itemize}

Saldırgan ve savunma arasındaki bu "silahlanma yarışı" sürekli evrilir. Saldırganlar yeni kaçınma yolları buldukça, güvenlik firmaları da bu kaçınma yöntemlerini tespit etmek için yeni karşı önlemler geliştirmek zorundadır.

\subsection{Automated Malware Analysis ve YARA Rule Development}

Otomatik kötü amaçlı yazılım analizi, büyük hacimli şüpheli dosyaları hızlı bir şekilde işlemek için sandbox'ları ve makine öğrenimini kullanır. YARA kuralları, bu otomasyonun ve tehdit avcılığının temel bir bileşenidir.

\textbf{YARA Kuralları:}
\begin{itemize}
    \item \textbf{Tanım:} Kötü amaçlı yazılım ailelerini veya belirli zararlı dosyaları metinsel veya ikili kalıplara göre tanımlamak için kullanılan, imza benzeri kurallardır.
    \item \textbf{Yapı:} Her kuralın bir adı, bir dizi metinsel veya hexadecimal dize (strings) ve bir koşul (condition) ifadesi bulunur.
\end{itemize}

\textbf{YARA Kuralı Geliştirme (Adım-Adım Örnek):}
Bir saldırganın, dosya şifreleme için bir parola içeren bir fidye yazılımı kullandığını varsayalım. Bu parola, YARA kuralı ile tespit edilebilir.

\textbf{Adım-Adım Uygulama:}
\begin{enumerate}
    \item \textbf{Kuralı Tanımlama:} Kurala açıklayıcı bir ad verilir. \texttt{rule Ransomware\_Encrypter\_Password : ransomware}
    \item \textbf{Dizgeleri Tanımlama:} Kötü amaçlı yazılıma özgü benzersiz metinsel veya ikili kalıplar belirlenir. Bu durumda, şifreleme parolası: \texttt{strings: \$a = "s3cr3t\_p4ssw0rd\_3ncr\_k3y"}
    \item \textbf{Koşulu Belirleme:} Bu dizgenin dosya içinde bulunması gerektiğini tanımlayan koşul belirlenir. \texttt{condition: \$a}
\end{enumerate}

\textbf{Tam YARA Kuralı Örneği:}
\begin{verbatim}
rule Ransomware_Encrypter_Password : ransomware
{
    meta:
        description = "Detects a known ransomware variant by its hardcoded encryption key."
        author = "Cybersecurity Analyst"
        date = "2024-10-27"
        tlp = "amber"

    strings:
        $a = "s3cr3t_p4ssw0rd_3ncr_k3y"
        $b = { 6A 40 68 00 30 00 00 6A 14 8D 91 }

    condition:
        ($a or $b) and filesize < 1MB
}
\end{verbatim}

YARA kuralları, otomatik analiz ve manuel tehdit avcılığı arasında bir köprü görevi görür. Bir tehdit avcısı, yaptığı araştırmada yeni ve bilinmeyen bir kötü amaçlı yazılım varyantı keşfettiğinde, bu kalıplara dayalı olarak bir YARA kuralı yazarak, manuel keşfini otomatik bir tespit kuralına dönüştürebilir.

\section{Threat Intelligence Integration ve Operationalization}

Tehdit istihbaratının operasyonelleştirilmesi, toplanan istihbaratın bir kuruluşun güvenlik süreçlerine ve teknolojilerine entegre edilerek, savunma yeteneklerini aktif olarak güçlendirmesi anlamına gelir. Bu, istihbaratın sadece bir bilgi yığını olmaktan çıkıp, eyleme geçirilebilir bir güvenlik varlığına dönüşmesini sağlar. Entegrasyon, SIEM, güvenlik duvarları, IDS/IPS ve EDR gibi güvenlik araçlarının, en son tehdit verileriyle beslenerek daha akıllı ve etkili hale getirilmesini içerir.

\subsection{SIEM ve SOAR Platform Entegrasyonu}

SIEM ve SOAR platformları, tehdit istihbaratını operasyonel hale getiren birbirini tamamlayıcı araçlardır.

\begin{itemize}
    \item \textbf{SIEM (Security Information and Event Management):} Çeşitli kaynaklardan (sunucular, güvenlik duvarları, uygulamalar) günlük ve olay verilerini toplar, korele eder ve analiz ederek güvenlik olaylarını tespit eder.
    \item \textbf{SOAR (Security Orchestration, Automation, and Response):} Güvenlik olaylarına yönelik yanıtı otomatikleştiren ve düzenleyen bir hizmetler setidir.
\end{itemize}

\textbf{Entegrasyon Senaryosu:}
Bir SIEM, yeni bir kötü amaçlı IP'den gelen bir oturum açma girişimi hakkında bir uyarı oluşturduğunda, bu uyarı otomatik olarak SOAR platformuna iletilir. SOAR, bu IP için bir "playbook"u tetikler. Bu playbook, IP'yi VirusTotal gibi kaynaklarda sorgular, bu IP'den gelen ağ trafiğini SIEM'de arar ve ilgili uç noktanın karantinaya alınması için EDR çözümüne komut gönderir. Bu işlemler, analiste zenginleştirilmiş verilerle birlikte bir bilet (ticket) atanmadan önce saniyeler içinde gerçekleşir.

SOAR, SIEM'den gelen "gürültü"yü azaltır ve analistlerin verimliliğini artırarak güvenlik operasyonları için bir "güç çarpanı" (force multiplier) görevi görür. Bu otomasyon, bir saldırganın ağ içinde yetki yükseltme veya veri sızdırma gibi hedeflerine ulaşmasını engellemek için hayati önem taşır.

\textbf{SIEM ve SOAR Karşılaştırma Tablosu}

\begin{tabularx}{\textwidth}{|l|X|X|}
\hline
\textbf{Özellik} & \textbf{SIEM} & \textbf{SOAR} \\
\hline
\textbf{Fonksiyon} & Veri toplama ve olay tespiti & Olay yanıtını otomasyon ve orkestrasyonu \\
\hline
\textbf{Odak Noktası} & Gelen verileri korelasyon yoluyla analiz etme & Güvenlik operasyonlarını otomatikleştirme \\
\hline
\textbf{Giriş Verisi} & Ham log ve olay verileri & İşlenmiş güvenlik verileri, SIEM uyarıları \\
\hline
\textbf{Otomasyon Seviyesi} & Veri toplama ve analizde sınırlı & Tam veya yarı otomasyon \\
\hline
\end{tabularx}

\subsection{Automated Threat Response ve Playbook Development}

Otomatik tehdit yanıtı, bir güvenlik olayına önceden tanımlanmış bir dizi eylemi tetikleyen bir süreçtir. Playbook'lar, bu eylemleri tanımlayan kılavuzlardır ve bir kuruluşun olay müdahale planının operasyonel bileşenini oluşturur.

\textbf{Playbook'un Ana Bileşenleri:}
\begin{enumerate}
    \item \textbf{Tetkikleme Koşulu (Initiating Condition):} Playbook'u neyin tetiklediğini belirler (örneğin, yüksek riskli bir uyarı, kullanıcı raporu).
    \item \textbf{Süreç Adımları (Process Steps):} Olayı çözmek için atılacak tüm teknik ve teknik olmayan adımları içerir.
    \item \textbf{Son Durum (End State):} Playbook'un istenen sonucunu (örneğin, olay çözüldü, hafifletildi, başka bir ekibe aktarıldı) tanımlar.
\end{enumerate}

\textbf{Playbook Geliştirme (Adım-Adım Kılavuz):}
\begin{enumerate}
    \item \textbf{Amacı ve Kapsamı Tanımlama:} Hangi tür olaylara (örneğin, kimlik avı, kötü amaçlı yazılım) yanıt vereceğini belirleyin.
    \item \textbf{Olası Eylemleri ve Bağımlılıkları Belirleme:} Tüm olası teknik eylemleri (IP adresini engelle, uç noktayı karantinaya al) ve iletişim adımlarını (yöneticileri uyar) listeleyin.
    \item \textbf{Temel İş Akışını Oluşturma:} Yalnızca kritik ve zorunlu adımları içeren temel bir iş akışı oluşturun.
    \item \textbf{Otomasyonu Entegre Etme:} Manuel görevleri otomatikleştirmek için SOAR'ı kullanın.
    \item \textbf{Son Durumları ve Yükseltmeleri Tanımlama:} Playbook'un ne zaman sona ereceğini ve ne zaman manuel müdahale için bir analiste yükseltilmesi gerektiğini belirleyin.
\end{enumerate}

Otomasyon ve playbook'lar, bir kuruluşun siber güvenlik kapasitesini artırır ve analistlerin daha azıyla daha fazlasını yapmasını sağlar. Otomatikleştirilmiş playbook'lar, olaylara reaksiyon süresini saatlerden saniyelere düşürebilir, bu da bir saldırganın hedeflerine ulaşmasını engellemek için kritik öneme sahiptir.

\subsection{Intelligence Sharing Communities ve Trust Groups}

Bilgi paylaşımı, tehdit istihbaratı programlarının temel taşıdır. Kuruluşlar, tehdit verilerini paylaşarak kolektif savunma yeteneklerini güçlendirirler. Bu, bir saldırıdan elde edilen bilgilerin daha geniş bir topluluk tarafından kullanılmasına olanak tanır, böylece tehditler daha hızlı tespit edilebilir ve savunmalar güçlendirilebilir.

\textbf{Paylaşım Türleri:}
\begin{itemize}
    \item \textbf{Tek Yönlü (Unidirectional):} Bir sağlayıcının abonelere bilgi aktardığı modeldir.
    \item \textbf{Çift Yönlü (Bidirectional):} Tarafların aktif olarak hem katkıda bulunduğu hem de bilgi aldığı modeldir.
\end{itemize}

\textbf{Topluluklar:}
\begin{itemize}
    \item \textbf{Bilgi Paylaşım ve Analiz Merkezleri (ISAC'ler):} Belirli sektörlerdeki kuruluşlar için oluşturulmuş, endüstri odaklı paylaşım platformlarıdır.
\end{itemize}

\textbf{Avantajlar:}
\begin{itemize}
    \item \textbf{Daha Hızlı Tehdit Tespiti:} Tehdit beslemeleri, bir organizasyonun kendi başına fark edemeyeceği tehditler hakkında erken uyarı sağlar.
    \item \textbf{Gelişmiş Savunma:} En son tehditler, zafiyetler ve saldırı vektörleri hakkında bilgi paylaşımı, organizasyonların savunmalarını proaktif olarak güçlendirmesine yardımcı olur.
\end{itemize}

Bilgi paylaşımının başarısı, paylaşılan verinin kalitesine, güvene ve gizliliğe bağlıdır. Kuruluşlar, itibar veya sorumluluk endişeleri nedeniyle güvenlik olaylarını ifşa etmekte tereddüt edebilirler. Ancak, etkin bir bilgi paylaşım topluluğu, üyelerin hassas bilgileri güvenli bir şekilde paylaşabilmesi için güçlü protokoller (şifreleme, anonimleştirme) ve karşılıklı güvene dayalı bir ortam gerektirir.

\subsection{Custom Threat Intelligence Development}

Özel tehdit istihbaratı, organizasyonun kendi benzersiz risk profiline, varlıklarına ve tehdit ortamına göre geliştirilen istihbarattır. Ticari beslemeler, genel bir tehdit görünümü sağlasa da, özel istihbarat, kaynakların en kritik ve kişiselleştirilmiş risklere odaklanmasını sağlar.

\textbf{Geliştirme Adımları:}
\begin{enumerate}
    \item \textbf{"Crown Jewels" (En Değerli Varlıklar) Analizi:} Saldırganların en çok hedefleyeceği kritik sistemleri ve verileri belirleyin.
    \item \textbf{Özel PIR'ler Oluşturma:} Kuruluşun benzersiz ihtiyaçlarına odaklanan sorular geliştirin.
    \item \textbf{Dahili Veri Madenciliği:} İç logları ve telemetri verilerini analiz ederek, harici beslemelerde bulunmayan tehditleri (örneğin, içeriden gelen tehditler veya bilinmeyen kötü amaçlı yazılım varyantları) bulun.
    \item \textbf{Dış Kaynaklarla Zenginleştirme:} Dahili bulguları, ticari beslemeler ve OSINT ile zenginleştirin.
\end{enumerate}

Özel tehdit istihbaratı, genel ticari beslemelerin ötesine geçerek bir kuruluşun savunma stratejisini saldırganın niyetleriyle hizalar. Bu, kaynakların en kritik risklere odaklanmasını sağlar ve ticari bir beslemeden elde edilemeyecek derinlikte içgörüler sunar.

\subsection{Threat Intelligence ROI Measurement ve Effectiveness}

Bir tehdit istihbaratı programının değerini kanıtlamak için, somut iş sonuçlarıyla ilişkilendiren metrikler kullanılmalıdır. Üst yönetim, güvenlik yatırımları için somut kanıtlar ister.

\textbf{ROI Ölçüm Metrikleri:}
\begin{itemize}
    \item \textbf{Azaltılan Ortalama Tespit Süresi (MTTD) ve Azaltılan Ortalama Yanıt Süresi (MTTR):} Tehdit istihbaratının, saldırıları daha hızlı tespit etmeye ve müdahale etmeye ne kadar yardımcı olduğunu gösterir.
    \item \textbf{Yanlış Pozitif Oranı:} Tehdit istihbaratından gelen uyarıların ne kadarının sahte olduğunu gösterir. Düşük oran, daha verimli bir SOC anlamına gelir.
    \item \textbf{Önlenen Olay Sayısı:} Tehdit istihbaratıyla proaktif olarak durdurulan kimlik avı, fidye yazılımı veya diğer saldırıların sayısı.
\end{itemize}

Tehdit istihbaratı, güvenlikteki bir "bileşen"den ziyade, finansal riski ve iş sürekliliğini doğrudan etkileyen stratejik bir iş yatırımıdır. MTTD ve MTTR gibi metrikler, tehdit istihbaratının bir ihlal maliyetini nasıl düşürdüğünü doğrudan gösterir, bu da güvenlik ekiplerinin bütçe taleplerini destekler ve siber güvenliğin iş hedefleriyle uyumunu sağlar.

\textbf{Tehdit İstihbaratının ROI Metrikleri Tablosu}

\begin{tabularx}{\textwidth}{|l|X|X|}
\hline
\textbf{Metrik} & \textbf{Tanım} & \textbf{İş Değerine Katkısı} \\
\hline
\textbf{MTTD Azaltma} & Bir tehdidi tespit etmek için gereken süredeki düşüş. & Saldırganın ağda kalma süresini ve potansiyel hasarı azaltır. \\
\hline
\textbf{MTTR Azaltma} & Bir tehdidin çözümlenmesi için gereken süredeki düşüş. & Olay müdahale maliyetlerini düşürür ve iş sürekliliğini sağlar. \\
\hline
\textbf{Yanlış Pozitif Azaltma} & Hatalı güvenlik uyarılarının azalması. & Analist yorgunluğunu önler ve operasyonel verimliliği artırır. \\
\hline
\textbf{Önlenen Olay Sayısı} & Tehdit istihbaratı ile proaktif olarak engellenen saldırı sayısı. & İhlalden kaynaklanan maliyetleri ve itibar kaybını önler. \\
\hline
\end{tabularx}